<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>HR Management System</title>
    <link rel="stylesheet" href="styles.css">
</head>
<body>
    <div class="sidebar">
        <h2>HR Management</h2>
        <ul>
            <li onclick="loadModule('employeeManagement')">Employee Management</li>
            <li onclick="loadModule('attendanceManagement')">Attendance Management</li>
            <li onclick="loadModule('leaveManagement')">Leave Management</li>
            <li onclick="loadModule('reports')">Reports</li>
        </ul>
    </div>
    <div class="main-content">
        <h2>Welcome to HR Management System</h2>
        <p>Select a module from the left menu to get started.</p>
        <div id="moduleContainer"></div>
    </div>

    <!-- JavaScript Code -->
    <script>
        function loadModule(moduleName) {
            let moduleContainer = document.getElementById("moduleContainer");

            if (moduleName === 'leaveManagement') {
                moduleContainer.innerHTML = `
                    <h3>Leave Management</h3>
                    <form id="leaveForm" onsubmit="submitLeaveRequest(event)">
                        <input type="text" name="employeeId" placeholder="Employee ID" required><br><br>
                        <input type="text" name="leaveType" placeholder="Leave Type" required><br><br>
                        <input type="date" name="startDate" required><br><br>
                        <input type="date" name="endDate" required><br><br>
                        <input type="hidden" name="sheetName" value="Leave Requests Sheet">
                        <button type="submit">Submit Leave Request</button>
                    </form>
                    <div id="leaveMessage"></div>
                `;
            } else if (moduleName === 'attendanceManagement') {
                moduleContainer.innerHTML = `
                    <h3>Attendance Management</h3>
                    <form id="attendanceForm" onsubmit="submitAttendance(event)">
                        <input type="text" name="employeeId" placeholder="Employee ID" required><br><br>
                        <input type="password" name="password" placeholder="Password" required><br><br>
                        <button type="submit">Mark Attendance</button>
                    </form>
                    <div id="attendanceMessage"></div>
                `;
            }
        }

        function submitLeaveRequest(event) {
            event.preventDefault();
            const form = event.target;
            const formData = new FormData(form);
            const params = new URLSearchParams(formData);

            fetch("YOUR_GOOGLE_SCRIPT_WEB_APP_URL", {
                method: "POST",
                body: params,
            })
            .then(response => response.json())
            .then(data => {
                document.getElementById("leaveMessage").innerText = data.message;
            })
            .catch(error => {
                document.getElementById("leaveMessage").innerText = "Error submitting leave request.";
            });
        }

        function submitAttendance(event) {
            event.preventDefault();
            const form = event.target;
            const formData = new FormData(form);
            const params = new URLSearchParams(formData);

            fetch("YOUR_GOOGLE_SCRIPT_WEB_APP_URL", {
                method: "POST",
                body: params,
            })
            .then(response => response.json())
            .then(data => {
                document.getElementById("attendanceMessage").innerText = data.message;
            })
            .catch(error => {
                document.getElementById("attendanceMessage").innerText = "Error marking attendance.";
            });
        }
    </script>
</body>
</html>
